<!DOCTYPE html>
<html>
<head>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
  <meta name='viewport' content='initial-scale=1.0,maximum-scale=1,user-scalable=no' />
  <style type='text/css'>
    body, html, #map { width: 100%; height: 100%; overflow: hidden; margin:0; }
  </style>
  <script type='text/javascript' src='http://api.map.baidu.com/api?v=2.0&ak=4yWbU5UAZzPq3zG136ioc188jR1p6j0t'></script>
  <title>BaiduMap</title>
</head>
<body>
  <div id='map'></div>
</body>
<script type='text/javascript'>
  var options;
  var firstLoad = true;

  function updateHash(hash) {
    window.location.hash = hash + '&date=' + new Date().getTime();
    return false;
  }

  function getOptions() {
    var center = map.getCenter();
    var zoom = map.getZoom();
    updateHash('centerLng=' + center.lng + '&centerLat=' + center.lat + '&zoom=' + zoom);
  }

  function setOptions(param) {
    if (!param) {
      return;
    }
    options = param;
  }

  var map = new BMap.Map('map');
  map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);
  map.enableScrollWheelZoom(true);
  map.addControl(new BMap.NavigationControl({ anchor: BMAP_ANCHOR_TOP_RIGHT, type: BMAP_NAVIGATION_CONTROL_ZOOM }));  
  map.addEventListener('tilesloaded',function(){
    if (!firstLoad) {
      return;
    }
    firstLoad = false;
    if (options && options.center) {
      map.centerAndZoom(new BMap.Point(options.center.lng, options.center.lat), options.zoom || 11);
    }
    getOptions();
  });
  map.addEventListener('dragend',function(){
    getOptions();
  });
  map.addEventListener('zoomend',function(){
    getOptions();
  });
</script>
</html>